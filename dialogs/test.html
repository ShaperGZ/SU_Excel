<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta charset="utf-8">
<title>WebProgram</title>
<script type="text/javascript">
    function display() {
        var a = document.getElementById("id1").value;
        var b = document.getElementById("id2").value;
        var c = document.getElementById("id3").value;
        var d = document.getElementById("id4").value;
        var str = a + "_" + b + "_" + c + "_" + d;
        window.location = 'skp:SetInfo@' + str;
    }

    function connect() {
        alert("尝试连接");
        var wsImpl = window.WebSocket || window.MozWebSocket;

        window.ws = new wsImpl('ws://127.0.0.1:8088/');

        ws.onmessage = function (msg) {
            displayContent(msg.data);
        };

        ws.onopen = function () {
            GetID("btnConnect").disabled = true;
            alert("连接成功！");
        };

        ws.onclose = function () {
            alert("断开连接!")
        }

        ws.onerror = function (e) {
            alert("出现异常!:" + e.data)
        }
    }

    //使用连接发送数据
    function send() {
        var msg = GetID("sendText").value + '\0'
        ws.send(msg);
    }

    function Tclose() {
        ws.close();
    }

    function GetID(id) { return document.getElementById(id); }

    function displayContent(msg) {
        GetID("txtContent").value += msg;
    }

</script>
<style>
h1
{
	text-align:center;
}	
p
{
	text-align:center;
}
#form
{
	text-align:center;
}
</style>
</head>

<body>
    <h1 style="color:white"><font size="6">Group Information</font></h1>
    <hr>
    <p style="font-family:arial;color:white;font-size:20px;">键入信息</p>
    <form action="" id="form">
        <b>分区:</b><input type="text" id="id1"><br><br>
        <b>业态:</b><input type="text" id="id2"><br><br>
        <b>栋:</b><input type="text" id="id3"><br><br>
        <b>层高:</b><input type="text" id="id4"><br><br>
    </form>
    <center><button id="b1" type="button" onclick="display()" style="font-size:16px;">确定</button></center>
    <input id="btnConnect" type="button" value="连接" onclick="connect()" />
    <div>
        <input id="sendText" type="text" placeholder="发送文本" value="你好啊！"/>
        <input id="btnSend" type="button" value="发送" onclick="send()" />
    </div>
    <div>
        <div>
            来自服务端的消息
        </div>
        <textarea id="txtContent" cols="50" rows="10" readonly="readonly"></textarea>
    </div>
    <hr>
</body>
</html>